---
title: "OASIS_selection"
output: html_document
date: "2024-03-29"
---

```{r setup, include=FALSE}
library(tidyverse)
```

```{r}
OASIS <- read.csv(file='../stimuli/oasis/OASIS.csv')
```

#filtering
```{r}
OASIS_clean <-
  OASIS %>%
  dplyr::filter(Category != "Person")

OASIS_clean$Valence_SE <- OASIS_clean$Valence_SD/(sqrt(OASIS_clean$Valence_N))

OASIS_clean$Arousal_SE <- OASIS_clean$Arousal_SD/(sqrt(OASIS_clean$Arousal_N))

ggplot(data=OASIS_clean, aes(x=Arousal_mean, y=Valence_mean))+
  geom_point() +
  geom_vline(xintercept = 3.5, linetype="dashed", color="red") +
  geom_hline(yintercept = 3.5, linetype="dashed", color="red")


OASIS_cleanpospos <- 
  OASIS_clean %>%
  dplyr::filter(Arousal_mean - Arousal_SE > 3.5) %>%
  dplyr::filter(Valence_mean - Valence_SE > 3.5)

OASIS_cleanpospos$quad <-"High Arousal, High Valence"

ggplot(data=OASIS_cleanpospos, aes(x=Arousal_mean, y=Valence_mean))+
  geom_point() +
  geom_vline(xintercept = 3.5, linetype="dashed", color="red") +
  geom_hline(yintercept = 3.5, linetype="dashed", color="red")

OASIS_cleannegpos <- 
  OASIS_clean %>%
  dplyr::filter(Arousal_mean + Arousal_SE < 3.5) %>%
  dplyr::filter(Valence_mean - Valence_SE > 3.5)

OASIS_cleannegpos$quad <-"Low Arousal, High Valence"

ggplot(data=OASIS_cleannegpos, aes(x=Arousal_mean, y=Valence_mean))+
  geom_point() +
  geom_vline(xintercept = 3.5, linetype="dashed", color="red") +
  geom_hline(yintercept = 3.5, linetype="dashed", color="red")

OASIS_cleannegneg <- 
  OASIS_clean %>%
  dplyr::filter(Arousal_mean + Arousal_SE < 3.5) %>%
  dplyr::filter(Valence_mean + Valence_SE < 3.5)

OASIS_cleannegneg$quad <-"Low Arousal, Low Valence"


ggplot(data=OASIS_cleannegneg, aes(x=Arousal_mean, y=Valence_mean))+
  geom_point() +
  geom_vline(xintercept = 3.5, linetype="dashed", color="red") +
  geom_hline(yintercept = 3.5, linetype="dashed", color="red")

OASIS_cleanposneg <- 
  OASIS_clean %>%
  dplyr::filter(Arousal_mean - Arousal_SE > 3.5) %>%
  dplyr::filter(Valence_mean + Valence_SE < 3.5)

OASIS_cleanposneg$quad <-"High Arousal, Low Valence"

ggplot(data=OASIS_cleanposneg, aes(x=Arousal_mean, y=Valence_mean))+
  geom_point() +
  geom_vline(xintercept = 3.5, linetype="dashed", color="red") +
  geom_hline(yintercept = 3.5, linetype="dashed", color="red")

stim_selection <- 
  rbind(OASIS_cleannegneg, OASIS_cleannegpos, OASIS_cleanposneg, OASIS_cleanpospos) %>%
  dplyr::select(Theme, quad)

write.csv(file='../stimuli/OASIS_initialstims.csv', stim_selection)
```

#try more stringent thresholds for positive valence, will filter based on appropriateness for negative
```{r}
filtered <- read.csv(file='../stimuli/OASIS_initialstims.csv')

updated <- merge(filtered, OASIS_clean, by="Theme") %>%
  select(Theme, Arousal_mean, Arousal_SE, Valence_mean, Valence_SE)

updated_cleanpospos <- 
  updated %>%
  dplyr::filter(Arousal_mean - Arousal_SE > 4.5) %>%
  dplyr::filter(Valence_mean - Valence_SE > 4.5)

updated_cleanpospos$quad <-"High Arousal, High Valence"

updated_cleannegpos <- 
  updated %>%
  dplyr::filter(Arousal_mean + Arousal_SE < 3) %>%
  dplyr::filter(Valence_mean - Valence_SE > 4.5)

updated_cleannegpos$quad <-"Low Arousal, High Valence"

pos_stim_selection1 <- 
  rbind(updated_cleanpospos, updated_cleannegpos) %>%
  dplyr::select(Theme, quad)

write.csv(file='../stimuli/OASIS_filteredpos.csv', pos_stim_selection1)
```